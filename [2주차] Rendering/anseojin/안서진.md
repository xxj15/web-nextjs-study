<h1> π“ Next.js 2μ£Όμ°¨ ν•™μµμ •λ¦¬

### π’΅ λ λ”λ§ (Rendering)

λ λ”λ§ : μ‘μ„±ν• μ½”λ“λ¥Ό μ‚¬μ©μ μΈν„°νμ΄μ¤λ΅ λ°”κΎΈλ” κ³Όμ •. React μ™€ Next.js λ¥Ό μ‚¬μ©ν•λ©΄ μ„λ²„ νΉμ€ ν΄λΌμ΄μ–ΈνΈμ—μ„ λ λ”λ§ ν•  μ μλ” ν•μ΄λΈλ¦¬λ“ μ›Ή μ–΄ν”λ¦¬μΌ€μ΄μ…μ„ λ§λ“¤ μ μλ‹¤.

## π“ μ„Έ κ°€μ§€ κΈ°λ³Έ μ›Ή μ»¨μ…‰

#### 1. λ λ”λ§ ν™κ²½ (Environments)

- μ• ν”λ¦¬μΌ€μ΄μ… μ½”λ“κ°€ μ‹¤ν–‰λ  μ μλ” ν™κ²½(Environments) - μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈ

![Rendering Environments](image.png)

β΅ κ³Όκ±°μ—λ” μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈκ°€ μ„λ΅ λ‹¤λ¥Έ μ–Έμ–΄μ™€ ν”„λ μ„μ›ν¬λ΅ κ°λ°λμ–΄μ•Ό ν–μΌλ‚, **Reactμ™€ Next.jsμ μ‚¬μ© μ΄ν›„** μ—λ” ν•λ‚μ ν”„λ μ„μ›ν¬ (ReactκΈ°λ°)μΌλ΅ μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈ λ¨λ‘μ—μ„ μ½”λ“ μ‘μ„±μ΄ κ°€λ¥ν•΄μ΅λ‹¤.

β΅νΉν Next.jsλ” μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈμ μ—­ν• μ„ ν•λ‚μ ν”„λ΅μ νΈ μ•μ—μ„ ν†µν•©ν•΄μ„ λ‹¤λ£° μ μκ² ν•΄μ£Όμ—λ‹¤. ν•μ§€λ§, μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈλ” **μ—­ν• κ³Ό ν™κ²½μ΄ λ‹¤λ¥΄κΈ° λ•λ¬Έ**μ— μ‘μ„±ν•λ” μ½”λ“κ°€ λ‹¤λ¥Ό μ μμΌλ©°, **κ°κ°μ ν™κ²½μ— λ” μ ν•©ν• κΈ°λ¥(λ°©μ‹)μ΄ μλ‹¤**λ” μ μ„ μ•μ•„λ‘¬μ•Ό ν•λ‹¤.

#### 2. μ”μ²­-μ‘λ‹µ λΌμ΄ν”„μ‚¬μ΄ν΄ (Request-Response Lifecycle)

- μΌλ°μ μΌλ΅ λ¨λ“  μ›Ήμ‚¬μ΄νΈλ” λ™μΌν• μ”μ²­-μ‘λ‹µ λΌμ΄ν”„ μ‚¬μ΄ν΄μ„ λ”°λ¥΄λ©°, μ‚¬μ©μκ°€ μ• ν”λ¦¬μΌ€μ΄μ…μ„ λ°©λ¬Έν•κ±°λ‚ μƒνΈ μ‘μ©ν•  λ• μ‹¤ν–‰λλ‹¤.

β΅ μ‚¬μ©μ ν–‰λ™ - HTTP μ”μ²­ - μ„λ²„(μ”μ²­ μ²λ¦¬ λ° μ‘λ‹µ) - HTTP μ‘λ‹µ - ν΄λΌμ΄μ–ΈνΈ(UI λ λ”λ§) - μ‚¬μ©μ ν–‰λ™ (μΈν„°νμ΄μ¤λ” μ‚¬μ©μμ™€ μƒνΈμ‘μ© κ°€λ¥ν•΄μ§)

β΅ **ν•μ΄λΈλ¦¬λ“ μ›Ή μ• ν”λ¦¬μΌ€μ΄μ…** μ„ κµ¬μ¶•ν•  λ•λ” λΌμ΄ν”„μ‚¬μ΄ν΄μ—μ„ μ‘μ—…μ„ μ–΄λ–»κ² λ¶„ν• ν•  κ²ƒμΈμ§€, λ„¤νΈμ›ν¬ κ²½κ³„λ¥Ό μ–΄λ””μ— λ‘ κ²ƒμΈμ§€ κ²°μ •ν•λ” κ²ƒμ΄ μ¤‘μ”ν•λ‹¤.

#### 3.λ„¤νΈμ›ν¬ κ²½κ³„(Network Boundary)

- λ‹¤λ¥Έ ν™κ²½μ„ κµ¬λ¶„ν•λ” κ°λ…μ μΈ μ„  (ex.ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„, μ„λ²„μ™€ DB κ°„μ κ²½κ³„)

- Reactμ "use client" κ·μΉ™
  - λ°”μ΄λ”λ¦¬ μ •μ κ°€λ¥
  - μ„λ²„μ—μ„ μΌλ¶€ κ³„μ‚° μ‘μ—… ν•λ„λ΅ Reactμ— μ§€μ‹ κ°€λ¥

### π” ν•μ΄λΈλ¦¬λ“ μ• ν”λ¦¬μΌ€μ΄μ… κµ¬μ¶•

- μ• ν”λ¦¬μΌ€μ΄μ…μ μ½”λ“ νλ¦„μ΄ **λ‹¨λ°©ν–¥** μ„μ„ μƒκ°ν•λ” κ²ƒμ€ λ„μ›€μ΄ λλ‹¤. μ‘λ‹µν•λ” λ™μ•, μ• ν”λ¦¬μΌ€μ΄μ… μ½”λ“λ” μ„λ²„μ—μ„ ν΄λΌμ΄μ–ΈνΈλ΅ λ‹¨λ°©ν–¥μΌλ΅ νλλ‹¤.

  - **ν΄λΌμ΄μ–ΈνΈμ—μ„ μ„λ²„μ— μ ‘κ·Ό**ν•΄μ•Ό ν•λ‹¤λ©΄, κ°™μ€ μ”μ²­μ„ μ¬μ‚¬μ©ν•λ” λ€μ‹  μ„λ²„μ—μ„ μƒ μ”μ²­μ„ λ³΄λ‚Έλ‹¤.
  - μ΄λ¥Ό ν†µν•΄ μ»΄ν¬λ„νΈλ¥Ό μ–΄λ””μ— λ λ”λ§ν• μ§€, λ„¤νΈμ›ν¬ κ²½κ³„λ¥Ό μ–΄λ””μ— λ‘μ§€ μ΄ν•΄ν•κΈ° μ‰¬μ›μ§„λ‹¤.

## π“ Server Components

- Reactμ—μ„ μ„λ²„ μ»΄ν¬λ„νΈλ¥Ό μ‚¬μ©ν•λ©΄ μ„λ²„μ—μ„ λ λ”λ§ν•κ³  μ„ νƒμ μΌλ΅ μΊμ‹ν•  μ μλ” UI λ¥Ό μ‘μ„±ν•  μ μλ‹¤.
- Next.jsμ—μ„λ” route segments (κ²½λ΅ μ„Έκ·Έλ¨ΌνΈ)λ³„λ΅ λ λ”λ§ μ‘μ—…μ„ μ¶”κ°€λ΅ λ¶„ν• ν•΄μ„ μ¤νΈλ¦¬λ°κ³Ό λ¶€λ¶„ λ λ”λ§μ΄ κ°€λ¥ν•κ² ν•λ‹¤.

#### π” μ„λ²„ λ λ”λ§μ 3κ°€μ§€ μ „λµ

1. Static Rendering
2. Dynamic Rendering
3. Streaming

### π“ μ„λ²„ λ λ”λ§μ μ΄μ 

- **Data Fetching (λ°μ΄ν„° κ°€μ Έμ¤κΈ°)**
  - λ°μ΄ν„° μ†μ¤μ— λ” κ°€κΉμ΄ μ„λ²„λ΅ λ°μ΄ν„°λ¥Ό κ°€μ Έμ¬ μ μλ‹¤.
  - κ·Έ κ²°κ³Ό, λ λ”λ§μ— ν•„μ”ν• λ°μ΄ν„°λ¥Ό κ°€μ Έμ¤λ” μ‹κ°„μ„ μ¤„μ΄κ³ , ν΄λΌμ΄μ–ΈνΈμ μ”μ²­ μλ¥Ό μ¤„μΌ μ μλ‹¤.
- **Security**
  - ν† ν°, API ν‚¤ λ“± λ―Όκ°ν• λ°μ΄ν„°λ¥Ό ν΄λΌμ΄μ–ΈνΈμ— λ…Έμ¶μ‹ν‚¤μ§€ μ•μ„ μ μλ‹¤.
- **Caching**
  - μ„λ²„μ—μ„ λ λ”λ§ν•λ©΄ κ²°κ³Όλ¥Ό μΊμ‹ν•κ³  μ΄ν›„ μ”μ²­κ³Ό λ‹¤λ¥Έ μ‚¬μ©μ κ°„μ— μ¬μ‚¬μ©ν•  μ μλ‹¤.
- **Performance**
  - μ„λ²„ μ»΄ν¬λ„νΈλ” κΈ°λ³Έ μ„±λ¥μ„ μµμ ν™”ν•λ” λ„κµ¬λ“¤μ„ μ¶”κ°€μ μΌλ΅ μ κ³µν•λ‹¤.
- **Initial Page Load and First Contentful Paint (FCP)**
  - μ΄κΈ° νμ΄μ§€ λ΅λ“μ™€ μ²« λ²μ§Έ μ½ν…μΈ  λ„λ‹¬ μ‹κ°„μ„ μ¤„μΌ μ μλ‹¤.
  - μ„λ²„λ” ν΄λΌμ΄μ–ΈνΈμ—μ„ JSλ¥Ό λ‹¤μ΄λ΅λ“, νμ‹±, μ‹¤ν–‰ν•λ” μ‹κ°„μ„ κΈ°λ‹¤λ¦¬μ§€ μ•κ³  νμ΄μ§€λ¥Ό μ¦‰μ‹ λ³Ό μ μλ„λ΅ HTMLμ„ μƒμ„±ν•  μ μλ‹¤.
- **Search Engine Optimization and Social Network Shareability**
- **Streaming**
  - μ„λ²„ μ»΄ν¬λ„νΈλ” λ λ”λ§ μ‘μ—…μ„ μ—¬λ¬ μ΅°κ°μΌλ΅ λ¶„ν• ν•κ³  μ¤€λΉ„λλ” λ€λ΅ ν΄λΌμ΄μ–ΈνΈμ— μ¤νΈλ¦¬λ°ν•  μ μλ‹¤.

### π“ Next.jsμ—μ„ μ„λ²„ μ»΄ν¬λ„νΈ μ‚¬μ©ν•κΈ°

- κΈ°λ³Έμ μΌλ΅ Next.jsλ” μ„λ²„ μ»΄ν¬λ„νΈλ¥Ό μ‚¬μ©ν•λ‹¤. (μ¶”κ°€ κµ¬μ„± μ—†μ΄ μ„λ²„ λ λ”λ§ κµ¬ν„ κ°€λ¥ & ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈλ” ν•„μ”μ‹ μ‚¬μ©)

### π“ μ„λ²„ μ»΄ν¬λ„νΈκ°€ λ λ”λ§ λλ” λ°©λ²•

μ„λ²„μ—μ„ Next.js λ” React API λ¥Ό ν™μ©ν•΄μ„ λ λ”λ§ν•λ‹¤

λ λ”λ§ μ‘μ—…μ€ **Route Segment**μ™€ **Suspense Boundary**λ¥Ό κΈ°μ¤€μΌλ΅ Chunkλ΅ μ¤ν”λ¦Ώλλ”λ°, κ°κ°μ μ²­ν¬λ” λ‘κ°€μ§€ λ‹¨κ³„λ¥Ό κ±°μ³μ„ λ λ”λ§λλ‹¤.

1. React: μ„λ²„ μ»΄ν¬λ„νΈλ¥Ό **RSC Payload (React Server Component Payload)** λΌλ” νΉμ λ°μ΄ν„° ν•μ‹μΌλ΅ λ λ”λ§
2. Next.js : RSC Payloadμ™€ ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈ JS instructionμ„ μ‚¬μ©ν•΄ HTML νμΌμ„ λ λ”λ§

3. μ΄ν›„ ν΄λΌμ΄μ–ΈνΈμ—μ„ ..
4. HTML : μ•„λ¬΄λ„ μƒνΈμ‘μ©ν•  μ μ—†μ§€λ§ λΉ λ¥΄κ² λ³΄μ—¬μ¤„ μ μλ” μ΄κΈ° ν™”λ©΄μ„ λ§λ“λ”λ° μ‚¬μ©ν•λ‹¤. (μ²μ νμ΄μ§€ λ΅λ”©μ‹μ—λ§)
5. RSC Payload : ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈ, μ„λ²„ μ»΄ν¬λ„νΈλ¥Ό μ΅°μ •ν•κ³ , DOMμ„ μ—…λ°μ΄νΈ
6. JS instruction : μ»΄ν¬λ„νΈ hydrate

#### π” RSC Payload?

- λ λ”λ§λ React μ„λ²„ μ»΄ν¬λ„νΈ νΈλ¦¬λ¥Ό μ»΄ν©νΈν• μ΄μ§„νΈλ¦¬λ΅ ν‘ν„ν• κ²ƒμΌλ΅, Reactκ°€ ν΄λΌμ΄μ–ΈνΈμ—μ„ λΈλΌμ°μ € DOMμ„ μ—…λ°μ΄νΈν•λ”λ° μ‚¬μ©λ¨.
  - μ„λ²„ μ»΄ν¬λ„νΈμ λ λ”λ§ κ²°κ³Ό
  - ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈκ°€ λ λ”λ§λ  μ„μΉμ placehoders & κ·Έ JS νμΌμ— λ€ν• μ°Έμ΅°
  - μ„λ²„ μ»΄ν¬λ„νΈμ—μ„ ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈλ΅ μ „λ‹¬ν• λ¨λ“  props

### π“ μ„λ²„ λ λ”λ§ μ „λµ

#### 1. Static Rendering (κΈ°λ³Έ μ„¤μ •)

β΅ λ°©λ²•

- λΉλ“ νƒ€μ„μ— ν•΄λ‹Ή κ²½λ΅ λ λ”λ§ or λ°μ΄ν„°λ¥Ό κ²€μ¦ν• ν›„ λ°±κ·ΈλΌμ΄λ“μ—μ„ λ λ”λ§
- κ²°κ³Όλ” μΊμ‹λμ–΄ CDNμΌλ΅ μ „μ†΅ κ°€λ¥

β΅ νΉμ§•

1. μ‚¬μ©μλ§λ‹¤ λ‹¬λΌμ§€λ” λ°μ΄ν„° X
2. λΉλ“ νƒ€μ„μ— λ…ν™•ν μ• μ μλ” λ°μ΄ν„°λ¥Ό ν™μ©ν•λ” κ²½λ΅μ—μ„ μ μ©ν•κ² μ‚¬μ©
   ex. λΈ”λ΅κ·Έ ν¬μ¤νΈμ μƒν’ νμ΄μ§€
3. μ‚¬μ©μλ“¤κ³Ό μ„λ²„ μ”μ²­ κ°„μ— λ λ”λ§ μ”μ²­ κ°€λ¥

#### 2. Dynamic Rendering

β΅ λ°©λ²•

- κ° μ‚¬μ©μμ μ”μ²­μ— κ²½λ΅λ¥Ό λ λ”λ§ν•¨.

β΅ νΉμ§•

1. μ‚¬μ©μλ³„λ΅ λ‹¬λΌμ§€λ” λ°μ΄ν„°κ°€ μλ” κ²½λ΅ μ”μ²­μ— μ μ©ν•κ² μ‚¬μ©
2. μΏ ν‚¤, URLμ params λ“± **μ”μ²­ν• μ‹μ μ—λ§** μ• μ μλ” μ •λ³΄κ°€ ν¬ν•¨λ κ²½λ΅μ—μ„ μ μ©ν•κ² μ‚¬μ©

#### 3. Streaming

β΅ λ°©λ²•

- Streamingμ„ ν™μ©ν•΄ μ„λ²„μ—μ„ UIλ¥Ό μ μ§„μ μΌλ΅ λ λ”λ§ν•  μ μλ‹¤.
  1. μ‘μ—…μ΄ μ—¬λ¬ μ²­ν¬λ΅ λ¶„ν• λ¨
  2. μ¤€λΉ„λλ” λ€λ΅ ν΄λΌμ΄μ–ΈνΈμ— streaming λ¨.
  3. μ‚¬μ©μ: μ „μ²΄ μ»¨ν…μΈ κ°€ λ λ”λ§μ„ μ™„λ£ν•κΈ° μ „, νμ΄μ§€μ μΌλ¶€λ¥Ό μ¦‰μ‹ λ³Ό μ μμ

β΅ Streaming

- Next.jsμ **App Router**μ— κΈ°λ³Έμ μΌλ΅ λ‚΄μ¥λμ–΄ μμ. - μ΄κΈ° νμ΄μ§€ λ΅λ”© μ„±λ¥κ³Ό λ΅λ”© μ†λ„κ°€ λλ¦° λ°μ΄ν„°λ¥Ό κ°€μ Έμ¤λ” UI μ„±λ¥ κ°μ„ ν•λ”λ° λ„μ›€μ„ μ¤.
- loading.jsμ™€ κ°™μ΄ React Suspenseλ¥Ό ν™μ©ν•΄ κ²½λ΅ segment μ¤νΈλ¦¬λ° μ‹μ‘λ„ κ°€λ¥

## π“ Client Components

ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈλ” μ„λ²„μ—μ„ μ‚¬μ „μ— λ λ”λ§λ UIλ¥Ό μƒνΈμ‘μ© κ°€λ¥ν•κ² λ§λ“¤μ–΄μ£Όλ©°, λΈλΌμ°μ €μ—μ„ ν΄λΌμ΄μ–ΈνΈ JSλ¥Ό μ‹¤ν–‰μ‹ν‚¬ μ μλ„λ΅ ν•΄μ¤€λ‹¤.

### β΅ ν΄λΌμ΄μ–ΈνΈ λ λ”λ§μ μ¥μ 

#### 1. μƒνΈμ‘μ©

- μƒνƒ, ν¨κ³Ό, μ΄λ²¤νΈ λ¦¬μ¤λ„ λ“±μ„ μ‚¬μ©ν•μ—¬ μ‚¬μ©μμ—κ² μ¦‰κ°μ μΈ ν”Όλ“λ°±μ„ μ κ³µν•κ³ , UI μ—…λ°μ΄νΈλ¥Ό ν•  μ μλ‹¤.

#### 2. λΈλΌμ°μ € API

- λΈλΌμ°μ € APIμ— μ ‘κ·Όν•  μ μλ‹¤.
  - geolocation (μ„μΉ μ •λ³΄ API) - μ‚¬μ©μμ ν„μ¬ μ„μΉ κ°€μ Έμ¤λ” κΈ°λ¥
  - localStorage (λ΅μ»¬ μ €μ¥μ†) - λΈλΌμ°μ €μ— λ°μ΄ν„° μ €μ¥ν•΄λ‘λ” κΈ°λ¥ (λ΅κ·ΈμΈ μ •λ³΄, ν…λ§ μ„¤μ •, μ¥λ°”κµ¬λ‚ μ €μ¥ λ“±)

```js
localStorage.setItem("username", "seojin");
const name = localStorage.getItem("username");
console.log(name); // 'seojin'
```

### β΅ ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈ μ‚¬μ©ν•κΈ°

![use Client](image-1.png)

β΅use Client

- μ„λ²„ μ»΄ν¬λ„νΈ, ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈ λ¨λ“ κ°„μ κ²½κ³„ μ„ μ–Έν•λ” μ—­ν• 
- ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈλ¥Ό μ‚¬μ©ν•κΈ° μ„ν•΄μ„λ” React μ **use client** λ””λ ‰ν‹°λΈλ¥Ό import λ¬Έλ³΄λ‹¤ λ” μ„μΈ νμΌ μµμƒλ‹¨μ— μ‚¬μ©ν•΄μ•Ό ν•¨.
- use Clientλ¥Ό νμΌμ— μ •μν•λ©΄ κ·Έ νμΌλ΅ κ°€μ Έμ¨ λ¨λ“  λ‹¤λ¥Έ λ¨λ“λ“¤κ³Ό, ν¬ν•¨λ μμ‹ μ»΄ν¬λ„νΈλ“¤κΉμ§€ ν΄λΌμ΄μ–ΈνΈ λ²λ“¤μ μΌλ¶€λ΅ κ°„μ£Όν•  μ μλ‹¤.

- React μ»΄ν¬λ„νΈ νΈλ¦¬μ—μ„ μ—¬λ¬ use clientμ μ—”νΈλ¦¬ ν¬μΈνΈλ¥Ό μ„¤μ •ν•  μ μλ‹¤.
  - μ• ν”λ¦¬μΌ€μ΄μ…μ„ μ—¬λ¬ ν΄λΌμ΄μ–ΈνΈ λ²λ“¤λ΅ λ¶„ν• ν•  μ μκ² ν•΄μ¤
  - ν•μ§€λ§, κ²½κ³„λ¥Ό ν• λ² μ •μν•λ©΄, κ·Έ μ•μΌλ΅ κ°€μ Έμ¨ λ¨λ“  μμ‹ μ»΄ν¬λ„νΈμ™€ λ¨λ“μ΄ ν΄λΌμ΄μ–ΈνΈ λ²λ“¤μ μΌλ¶€λ΅ κ°„μ£ΌλκΈ° λ•λ¬Έμ—, ν΄λΌμ΄μ–ΈνΈμ—μ„ λ λ”λ§ ν•΄μ•Όν•λ” λ¨λ“  μ»΄ν¬λ„νΈμ— use clientλ¥Ό μ •μν•  ν•„μ”λ” μ—†λ‹¤!

### β΅ ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈμ λ λ”λ§ λ°©μ‹

#### π“ #1 Full Page Load (μ „μ²΄ νμ΄μ§€ λ΅λ“)

- Next.jsλ” React APIλ¥Ό ν™μ©ν•μ—¬ ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈμ™€ μ„λ²„ μ»΄ν¬λ„νΈ λ¨λ‘μ— λ€ν•΄ μ •μ  HTML λ―Έλ¦¬λ³΄κΈ°λ¥Ό μ„λ²„μ—μ„ λ λ”λ§ν•λ‹¤. (μ΄κΈ° νμ΄μ§€ λ΅λ“)

  => μ‚¬μ©μκ°€ μ• ν”λ¦¬μΌ€μ΄μ… λ°©λ¬Έν•λ©΄ **ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈ**μ—μ„ μ‚¬μ©λ  JS λ²λ“¤μ„ λ‹¤μ΄λ΅λ“, νμ‹±, μ‹¤ν–‰ν•  ν•„μ” μ—†μ΄ νμ΄μ§€μ λ‚΄μ© μ¦‰μ‹ ν™•μΈ κ°€λ¥

β΅ μ„λ²„μ—μ„ μ§„ν–‰λλ” κ³Όμ •

1. React : ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈμ— λ€ν• μ°Έμ΅° λ°μ΄ν„°κ°€ μλ” νΉλ³„ λ°μ΄ν„° ν•μ‹μΈ RSC Payload λ΅ μ„λ²„ μ»΄ν¬λ„νΈλ“¤μ„ λ λ”λ§ν•¨.
2. Next.js : RSC Payload μ™€ ν΄λΌμ΄μ–ΈνΈ JS instructions μ„ μ‚¬μ©ν•΄ μ„λ²„μ—μ„ ν•΄λ‹Ή κ²½λ΅μ— λ€ν• HTML μ„ λ λ”λ§ν•¨.

#### 3. μ΄ν›„μ— ν΄λΌμ΄μ–ΈνΈμ—μ„λ” ..

1. HTML νμΌ : μƒνΈμ‘μ© X, κ°€μ¥ λΉ λ¥΄κ² λ³΄μ—¬μ§€λ” ν™”λ©΄ μ κ³µ
2. RSC Payload : ν΄λΌμ΄μ–ΈνΈ λ° μ„λ²„ μ»΄ν¬λ„νΈ νΈλ¦¬ μ΅°μ • & DOM μ—…λ°μ΄νΈ
3. JS instructions : ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈ hydrate

- hydrate : μ •μ  HTMLμ„ μƒνΈμ‘μ©ν•κ² λ§λ“¤κΈ° μ„ν•΄ DOMμ— eventlistener μ—°κ²°ν•λ” κ³Όμ •. (λ‚΄λ¶€μ μΌλ΅λ” hydrateRootλΌλ” React API ν™μ©)

#### π“ #2 ν›„μ† νƒμƒ‰

- ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈλ” **μ„λ²„μ—μ„ λ λ”λ§λ HTML μ—†μ΄** μ „μ μΌλ΅ **ν΄λΌμ΄μ–ΈνΈ**μ—μ„ λ λ”λ§.

## π“ Composition Patterns

React μ• ν”λ¦¬μΌ€μ΄μ…μ„ λΉλ“ν•  λ•, μ΄ μ• ν”λ¦¬μΌ€μ΄μ…μ΄ **μ„λ²„μ—μ„** λ λ”λ§λμ–΄μ•Ό ν• μ§€, **ν΄λΌμ΄μ–ΈνΈ**μ—μ„ λ λ”λ§ν•΄μ•Όν• μ§€μ— λ€ν• κ³ λ―Όμ„ ν•΄μ•Ό ν•λ‹¤.

#### β΅μ„λ²„ μ»΄ν¬λ„νΈ vs ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈ μ‚¬μ© μ‹κΈ°

![Composition Pattern](image-2.png)

#### π” μ„λ²„ μ»΄ν¬λ„νΈ ν¨ν„΄

- Client Side Rendering μ„ μ„ νƒν•κΈ° μ „, μ„λ²„μ—μ„ λ°μ΄ν„°λ¥Ό fetching ν•κ±°λ‚, dbλ‚ λ°±μ—”λ“ μ„λΉ„μ¤μ— μ ‘κ·Όν•  μ μλ‹¤.

#### β΅ μ„λ²„ μ»΄ν¬λ„νΈλ΅ μ‘μ—…ν•  λ• ν”ν μ‚¬μ©λλ” ν¨ν„΄

##### 1. μ»΄ν¬λ„νΈ κ°„ λ°μ΄ν„° κ³µμ 

- κ°™μ€ λ°μ΄ν„°μ— μμ΅΄ν•λ” λ μ΄μ•„μ›ƒκ³Ό νμ΄μ§€ λ“±, μ„λ²„μ—μ„ λ°μ΄ν„°λ¥Ό κ°€μ Έμ¬ λ•, λ‹¤λ¥Έ μ»΄ν¬λ„νΈ κ°„μ— κ°€μ Έμ¨ λ°μ΄ν„°λ¥Ό κ³µμ ν•΄μ•Ό ν•  κ²½μ°κ°€ μλ‹¤.

β μλ»λ μ ‘κ·Ό

- React Context (μ„λ²„ μ»΄ν¬λ„νΈμ—μ„λ” μ‚¬μ© λ¶κ°€)
- propsλ΅ κ³„μ† μ „λ‹¬ν•λ” κ²ƒ

π” κ¶μ¥ν•λ” λ°©λ²•

- fetch() λλ” Reactμ cache() ν•¨μ ν™μ©
  - ν•„μ”ν• μ»΄ν¬λ„νΈ κ°κ°μ—μ„ κ°™μ€ λ°μ΄ν„°λ¥Ό λ‹¤μ‹ fetchν•΄λ„ **μ¤‘λ³µ μ”μ²­μ΄ λ°μƒν•μ§€ μ•μ** (Reactκ°€ μλ™μΌλ΅ μ¤‘λ³µ μ”μ²­ λ§‰μ•„μ¤μ¤)
  - Reactλ” fetch μ”μ²­μ„ μλ™μΌλ΅ memoize ν•κΈ° λ•λ¬Έμ—, κ°™μ€ μ”μ²­μ΄λ©΄ **ν• λ²λ§ λ„¤νΈμ›ν¬ νΈμ¶**ν•κ³ , κ²°κ³Όλ¥Ό **μ¬μ‚¬μ©**ν•¨.
    - fetchλ¥Ό μ‚¬μ©ν•  μ μ—†λ” μƒν™©μ΄λ©΄ cache() ν•¨μλ΅ κ°™μ€ κΈ°λ¥ κµ¬ν„ κ°€λ¥.

##### 2. ν΄λΌμ΄μ–ΈνΈ ν™κ²½μ—μ„ μ„λ²„ μ½”λ“ μ μ§€ (μ„λ²„ μ „μ© μ½”λ“κ°€ μ‹¤ν–‰λμ§€ μ•κ²)

β΅λ¬Έμ μ  λ° μ„ν—ν—

- JS λ¨λ“μ€ μ„λ²„ λ° ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈ λ¨λ“ κ°„μ— κ³µμ λ  μ μλ‹¤. λ”°λΌμ„, μ¤μ§ μ„λ²„μ—μ„λ§ μ‹¤ν–‰λ  μλ„λ΅ μ‘μ„±λ μ½”λ“κ°€ ν΄λΌμ΄μ–ΈνΈλ΅ μ μ…λ  μ μλ‹¤.
  - **μ„λ²„μ—μ„λ§ μ‹¤ν–‰**λμ–΄μ•Ό ν•λ” μ½”λ“ μ: API ν‚¤λ¥Ό μ‚¬μ©ν•λ” μ½”λ“
- process.env.API_KEYμ²λΌ NEXT_PUBLICμ΄ μ—†λ” ν™κ²½ λ³€μλ” μ„λ²„μ—μ„λ§ μ ‘κ·Ό κ°€λ¥ν•¨
  - ν΄λΌμ΄μ–ΈνΈμ—μ„λ” λΉ λ¬Έμμ—΄λ΅ λ€μ²΄λ¨.
- getData() κ°™μ€ μ„λ²„ μ „μ© ν•¨μλ¥Ό ν΄λΌμ΄μ–ΈνΈμ—μ„ κ°€μ Έμ¤λ©΄ μ½”λ“κ°€ λ™μ‘ν•μ§€ μ•κ±°λ‚ λ³΄μ•μ— λ¬Έμ κ°€ μƒκΈΈ μ μμ.
- λ―Όκ°ν• μ •λ³΄λ¥Ό ν΄λΌμ΄μ–ΈνΈμ— λ…Έμ¶ν•λ” μ‹¤μ κ°€λ¥μ„±.

β΅ μ„λ²„ μ½”λ“μ μλ„μΉ μ•μ€ ν΄λΌμ΄μ–ΈνΈ μ‚¬μ© λ°©μ§€λ¥Ό μ„ν• λ°©λ²•

- server-only ν¨ν‚¤μ§€ μ‚¬μ©

  - μ„λ²„ μ „μ© λ¨λ“ μƒλ‹¨μ— import 'server-only' μ¶”κ°€
  - ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈμ—μ„ ν•΄λ‹Ή λ¨λ“μ„ κ°€μ Έμ¤λ©΄ λΉλ“ νƒ€μ„ μ—λ¬ λ°μƒ

- λ°λ€λ΅, ν΄λΌμ΄μ–ΈνΈ μ „μ© λ¨λ“μ€ `client-only`λ΅ κ΄€λ¦¬ κ°€λ¥

##### 3. μ„λ“νν‹° ν¨ν‚¤μ§€ λ° Provider μ‚¬μ©

π“ 1. ν΄λΌμ΄μ–ΈνΈ μ „μ© κΈ°λ¥κ³Ό use client

- useState, useEffect, createContextμ™€ κ°™μ€ **ν΄λΌμ΄μ–ΈνΈ μ „μ© κΈ°λ¥**μ€ μ„λ²„ μ»΄ν¬λ„νΈμ—μ„ μ‚¬μ© λ¶κ°€.
  - μ„λ“νν‹° μ»΄ν¬λ„νΈλ“¤μ΄ μ΄λ° κΈ°λ¥μ„ μ‚¬μ©ν•λ©΄μ„ `use Client` μ§€μ‹μ–΄λ¥Ό μ• λ¶™μΈ κ²½μ°κ°€ λ§μ€λ°, μ΄ κ²½μ° μ„λ²„ μ»΄ν¬λ„νΈμ—μ„ λ°”λ΅ μ‚¬μ©ν•λ©΄ μ—λ¬κ°€ λ°μƒ.

π’΅ν•΄κ²° λ°©λ²• : ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈλ΅ κ°μ‹ΈκΈ°

π“ 2. Context Providerλ” ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈ μ•μ— μ„μΉν•΄μ•Ό ν•¨

- React.createContext()λ” μ„λ²„ μ»΄ν¬λ„νΈμ—μ„λ” μ§€μ›λμ§€ μ•μ

π’΅ν•΄κ²° λ°©λ²• : Client Componentλ΅ λ”°λ΅ λ¶„λ¦¬ν•΄μ„ Provider μ‘μ„±

π“ μ •λ¦¬
| μƒν™© | ν•΄κ²° λ°©λ²• |
|-----------------------------------|--------------------------------------------------|
| ν΄λΌμ΄μ–ΈνΈ μ „μ© κΈ°λ¥ μ“°λ” μ„λ“νν‹° μ»΄ν¬λ„νΈ | `'use client'`λ΅ κ°μ‹Έμ„ λ³„λ„ μ»΄ν¬λ„νΈλ΅ λ§λ“¦ |
| Context μ‚¬μ© | Providerλ¥Ό ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈμ—μ„ λ¶„λ¦¬ μ‘μ„± |
| λ£¨νΈ μ»΄ν¬λ„νΈ μµμ ν™” | Providerλ” `children`λ§ κ°μ‹Έλ„λ΅ ν•¨ |

#### π” ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈ ν¨ν„΄ (κ΄€λ¦¬ μ „λµ)

1. Client Componentλ” νΈλ¦¬ μ•„λλ΅ μ®κΈ΄λ‹¤

- ν΄λΌμ΄μ–ΈνΈλ΅ λ³΄λ‚΄λ” JS λ²λ“¤ ν¬κΈ° μ¤„μ΄κΈ°
- ex. Layout μ „μ²΄λ¥Ό Client Componentλ΅ λ§λ“¤μ§€ λ§κ³ , μΈν„°λ™ν‹°λΈν• λ¶€λ¶„λ§ λ¶„λ¦¬

2. Server -> Clientλ΅ props μ „λ‹¬ μ‹ μ£Όμ

- Server Componentμ—μ„ κ°€μ Έμ¨ λ°μ΄ν„°λ¥Ό Client Componentλ΅ propsλ΅ μ „λ‹¬ν•  μ μμ
- λ‹¨, propsλ” λ°λ“μ‹ serializable ν•΄μ•Όν•¨.
  - μ§λ ¬ν™” κ°€λ¥ν• λ°μ΄ν„° (ex. κ°μ²΄, λ¬Έμμ—΄, λ°°μ—΄ λ“±) : κ·Έλ€λ΅ props μ „λ‹¬
  - λ¶κ°€λ¥ν• λ°μ΄ν„° (ex. ν•¨μ, ν΄λμ¤ μΈμ¤ν„΄μ¤ λ“±) : ν΄λΌμ΄μ–ΈνΈμ—μ„ μ§μ ‘ fetchν•κ±°λ‚ Route Handler μ΄μ©

#### π” μ„λ²„ μ»΄ν¬λ„νΈ, ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈ κµμ°¨ μ‚¬μ© (Interleaving)

β΅ μ»΄ν¬λ„νΈ νΈλ¦¬μ—μ„ Server β†” Clientλ¥Ό μ„μ–΄ μ‚¬μ©ν•λ” λ°©λ²•

- κΈ°λ³Έ κµ¬μ΅° : layout.tsx κ°™μ€ λ£¨νΈλ” Server Component
- Client Componentλ΅ λ¶„κΈ°ν•λ ¤λ©΄ `use client` μ§€μ‹μ–΄λ΅ λ…μ‹
- ν΄λΌμ΄μ–ΈνΈ ν•μ„μ—μ„λ„ Server Componentλ¥Ό μ¤‘μ²©ν•  μ μμ
  - μ£Όμν• μ  1. ν΄λΌμ΄μ–ΈνΈ β†’ μ„λ²„λ΅ λλμ•„κ°€λ” κ±΄ μ•„λ‹
    - ν΄λΌμ΄μ–ΈνΈμ—μ„ μ„λ²„ μμ›μ΄ ν•„μ”ν•λ©΄ β†’ μƒ μ”μ²­(request) λ°μƒ (Server Componentλ” μ²μ μ”μ²­μ—μ„ μ „λ¶€ λ¨Όμ € λ λ”λ§λ¨)
    - Client Componentλ” Server Componentλ¥Ό μ§μ ‘ import λ¶κ°€ (ν΄λΌμ΄μ–ΈνΈμ—μ„ μ„λ²„ μ½”λ“λ¥Ό λ¶λ¬μ¤λ©΄ λλ‹¤μ‹ μ„λ²„ μ”μ²­μ„ λ§λ“¤μ–΄μ•Ό ν•κΈ° λ•λ¬Έ)

| κ°λ…                      | μ„¤λ…                                                                         |
| ------------------------- | ---------------------------------------------------------------------------- |
| Server β†’ Client νΌν•© κµ¬μ„± | νΈλ¦¬ ν•νƒλ΅ μ¤‘μ²© μ‚¬μ© κ°€λ¥ (`use client` ν•μ„μ—λ„ Server μ»΄ν¬λ„νΈ μ‚¬μ© κ°€λ¥) |
| μ§μ ‘ import λ¶κ°€          | Client Componentμ—μ„ Server Component μ§μ ‘ import λ¶κ°€                       |
| propsλ΅ μ „λ‹¬μ€ κ°€λ¥       | Server Componentλ¥Ό children λλ” propsλ΅ Client Componentμ— μ „λ‹¬ κ°€λ¥        |

## π“ Runtimes

Next.jsμ—λ” μ• ν”λ¦¬μΌ€μ΄μ…μ—μ„ μ‚¬μ©ν•  μ μλ” λ‘ κ°€μ§€ μ„λ²„ λ°νƒ€μ„μ΄ μλ‹¤.

1. Node.js λ°νƒ€μ„ (κΈ°λ³Έ)

- λ¨λ“  Node.js APIμ™€ μ—μ½”μ‹μ¤ν…μ—μ„ μ κ³µλλ” νΈν™ κ°€λ¥ν• ν¨ν‚¤μ§€λ“¤μ„ μ‚¬μ© κ°€λ¥

β΅ μ‚¬μ©

- μ• ν”λ¦¬μΌ€μ΄μ… λ λ”λ§ ν•  λ•

2. Edge λ°νƒ€μ„

- Middlewareμ κΈ°λ³Έ λ°νƒ€μ„.
- μ ν•λ API μ„ΈνΈλ¥Ό κ°€μ§€κ³  μμ.

β΅μ‚¬μ©

- Middlewareμ„ μ„ν•΄ μ‚¬μ© (setting routing rules - redirection, rewrite, setting headers)

π“ μ°Έκ³  μλ£ λ° λλ‚€μ 
https://nextjs.org/docs/app/building-your-application/rendering/composition-patterns

μ–‘μ΄ λ„λ¬΄ λ§λ‹¤. π« 
